{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block body_attrs %} data-mode="{{ mode }}"{% endblock %}

{% block content %}
<header class="auth-top-bar" data-animate="fade">
  <a class="back-link" href="/">&larr; Back to landing</a>
  <span class="brand-mark">SmartDesk</span>
</header>
<main class="auth-layout">
  <section class="auth-intro" data-animate="fade">
    <h1 class="hero-title">Access your SmartDesk workspace</h1>
    <p class="hero-subtitle">Authenticate to reach your personalised dashboard, manage tickets, and collaborate across teams in one command centre.</p>
    <ul>
      <li>Unified entry point for requesters, IT managers, and SmartDesk operations teams.</li>
      <li>Secure sessions with automatic expiration, email verification, and device-aware login tracking.</li>
      <li>Instant redirect to the workspace that matches your assigned role.</li>
    </ul>
  </section>
  <section class="auth-card" data-animate="fade">
    <div class="mode-switch">
      <button type="button" class="mode-button{% if mode == 'login' %} is-active{% endif %}" data-switch="login">Log in</button>
      <button type="button" class="mode-button{% if mode == 'signup' %} is-active{% endif %}" data-switch="signup">Sign up</button>
    </div>
    <div class="oauth-actions">
      <button type="button" class="oauth-button" data-action="oauth-google">Continue with Google</button>
    </div>
    <div class="divider">or use your work email</div>
    <div class="form-panel{% if mode == 'login' %} is-active{% endif %}" data-panel="login">
      <form data-form="login">
        <div class="field">
          <label for="login-email">Work email</label>
          <input id="login-email" name="email" type="email" autocomplete="email" required>
        </div>
        <div class="field">
          <label for="login-password">Password</label>
          <div class="password-wrapper">
            <input id="login-password" name="password" type="password" minlength="8" autocomplete="current-password" required>
            <button type="button" class="toggle-password" data-target="login-password">Show</button>
          </div>
        </div>
        <div class="form-message" role="status"></div>
        <button type="submit" class="button button-primary">Access your workspace</button>
        <p class="form-footer">New to SmartDesk? <span class="switch-link" data-switch="signup">Create an account instead.</span></p>
        <p class="form-footer">Haven't verified your email? <span class="resend-link" data-resend>Resend verification email.</span></p>
      </form>
    </div>
    <div class="form-panel{% if mode == 'signup' %} is-active{% endif %}" data-panel="signup">
      <form data-form="signup">
        <div class="field">
          <label for="signup-email">Work email</label>
          <input id="signup-email" name="email" type="email" autocomplete="email" required>
        </div>
        <div class="field">
          <label for="signup-password">Password</label>
          <div class="password-wrapper">
            <input id="signup-password" name="password" type="password" minlength="8" autocomplete="new-password" required>
            <button type="button" class="toggle-password" data-target="signup-password">Show</button>
          </div>
          <span class="password-hint">Use at least 8 characters with upper/lowercase letters and a digit.</span>
        </div>
        <div class="field">
          <label for="signup-name">Full name <span class="field-optional">(optional)</span></label>
          <input id="signup-name" name="full_name" type="text" autocomplete="name">
        </div>
        <div class="field">
          <label for="signup-role">Primary role</label>
          <select id="signup-role" name="primary_role">
            {% for role in roles %}
              <option value="{{ role.value }}"{% if role.value == 'requester' %} selected{% endif %}>{{ role.label }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="field-inline">
          <div class="field">
            <label for="signup-title">Job title <span class="field-optional">(optional)</span></label>
            <input id="signup-title" name="job_title" type="text">
          </div>
          <div class="field">
            <label for="signup-department">Department <span class="field-optional">(optional)</span></label>
            <input id="signup-department" name="department" type="text">
          </div>
        </div>
        <div class="field">
          <label for="signup-org">Organisation name <span class="field-optional">(optional)</span></label>
          <input id="signup-org" name="organization_name" type="text" placeholder="e.g. Stellar Tech">
        </div>
        <div class="field">
          <label for="signup-org-slug">Organisation slug <span class="field-optional">(optional)</span></label>
          <input id="signup-org-slug" name="organization_slug" type="text" placeholder="stellar-tech">
        </div>
        <div class="form-message" role="status"></div>
        <button type="submit" class="button button-primary">Create and continue</button>
        <p class="form-footer">Already onboarded? <span class="switch-link" data-switch="login">Log in with your SmartDesk credentials.</span></p>
      </form>
    </div>
  </section>
</main>
<footer class="footer">
  <span>&copy; {{ year }} SmartDesk. Secure access for modern service teams.</span>
  <span>Questions? Contact your SmartDesk administrator.</span>
</footer>
{% endblock %}

{% block scripts %}
  <script src="/static/scripts/auth.js" defer></script>
{% endblock %}
